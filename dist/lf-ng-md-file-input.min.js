!function(p,g,v){"use strict";function b(){return"lfobjyxxxxxxxx".replace(/[xy]/g,function(e){var i=16*Math.random()|0;return("x"==e?i:3&i|8).toString(16)})}function C(e){var i=e.type,e=e.name;return n(i,e)?"image":l(i,e)?"video":t(i,e)?"audio":"object"}var n=function(e,i){return!(!e.match("image.*")&&!i.match(/\.(gif|png|jpe?g)$/i))},l=function(e,i){return!(!e.match("video.*")&&!i.match(/\.(og?|mp4|webm|3gp)$/i))},t=function(e,i){return!(!e.match("audio.*")&&!i.match(/\.(ogg|mp3|wav)$/i))},e=g.module("lfNgMdFileInput",["ngMaterial"]);e.directive("lfFile",function(){return{restrict:"E",scope:{lfFileObj:"=",lfUnknowClass:"="},link:function(e,i,n){var l=e.lfFileObj.lfDataUrl,t=e.lfFileObj.lfFileType,o=e.lfFileObj.lfTagType,s=e.lfUnknowClass;switch(o){case"image":i.replaceWith('<img src="'+l+'" />');break;case"video":i.replaceWith('<video controls><source src="'+l+'""></video>');break;case"audio":i.replaceWith('<audio controls><source src="'+l+'""></audio>');break;default:null==e.lfFileObj.lfFile&&(t="unknown/unknown"),i.replaceWith('<object type="'+t+'" data="'+l+'"><div class="lf-ng-md-file-input-preview-default"><md-icon class="lf-ng-md-file-input-preview-icon '+s+'"></md-icon></div></object>')}}}}),e.run(["$templateCache",function(e){e.put("lfNgMdFileinput.html",['<div layout="column" class="lf-ng-md-file-input" ng-model="'+b()+'">','<div layout="column" class="lf-ng-md-file-input-preview-container" ng-class="{\'disabled\':isDisabled}" ng-show="isDrag || (isPreview && lfFiles.length)">','<md-button aria-label="remove all files" class="close lf-ng-md-file-input-x" ng-click="removeAllFiles($event)" ng-hide="!lfFiles.length || !isPreview" >&times;</md-button>','<div class="lf-ng-md-file-input-drag">','<div layout="row" layout-align="center center" class="lf-ng-md-file-input-drag-text-container" ng-show="(!lfFiles.length || !isPreview) && isDrag">','<div class="lf-ng-md-file-input-drag-text">{{strCaptionDragAndDrop}}</div>',"</div>",'<div class="lf-ng-md-file-input-thumbnails" ng-if="isPreview == true">','<div class="lf-ng-md-file-input-frame" ng-repeat="lffile in lfFiles" ng-click="onFileClick(lffile)">','<div class="lf-ng-md-file-input-x" aria-label="remove {{lffile.lFfileName}}" ng-click="removeFile(lffile,$event)">&times;</div>','<lf-file lf-file-obj="lffile" lf-unknow-class="strUnknowIconCls"/>','<div class="lf-ng-md-file-input-frame-footer">','<div class="lf-ng-md-file-input-frame-caption">{{lffile.lfFileName}}</div>',"</div>","</div>","</div>",'<div class="clearfix" style="clear:both"></div>',"</div>","</div>",'<div layout="row" class="lf-ng-md-file-input-container" >','<div class="lf-ng-md-file-input-caption" layout="row" layout-align="start center" flex ng-class="{\'disabled\':isDisabled}" >','<md-icon class="lf-icon" ng-class="strCaptionIconCls"></md-icon>','<div flex class="lf-ng-md-file-input-caption-text-default" ng-show="!lfFiles.length">',"{{strCaptionPlaceholder}}","</div>",'<div flex class="lf-ng-md-file-input-caption-text" ng-hide="!lfFiles.length">','<span ng-if="isCustomCaption">{{strCaption}}</span>','<span ng-if="!isCustomCaption">','{{ lfFiles.length == 1 ? lfFiles[0].lfFileName : lfFiles.length+" files selected" }}',"</span>","</div>",'<md-progress-linear md-mode="determinate" value="{{floatProgress}}" ng-show="intLoading && isProgress"></md-progress-linear>',"</div>",'<md-button aria-label="remove all files" ng-disabled="isDisabled" ng-click="removeAllFiles()" ng-hide="!lfFiles.length || intLoading" class="md-raised lf-ng-md-file-input-button lf-ng-md-file-input-button-remove" ng-class="strRemoveButtonCls">','<md-icon class="lf-icon" ng-class="strRemoveIconCls"></md-icon> ',"{{strCaptionRemove}}","</md-button>",'<md-button aria-label="submit" ng-disabled="isDisabled" ng-click="onSubmitClick()" class="md-raised md-warn lf-ng-md-file-input-button lf-ng-md-file-input-button-submit" ng-class="strSubmitButtonCls" ng-show="lfFiles.length && !intLoading && isSubmit">','<md-icon class="lf-icon" ng-class="strSubmitIconCls"></md-icon> ',"{{strCaptionSubmit}}","</md-button>",'<md-button aria-label="browse" ng-disabled="isDisabled" ng-click="openDialog($event, this)" class="md-raised lf-ng-md-file-input-button lf-ng-md-file-input-button-brower" ng-class="strBrowseButtonCls">','<md-icon class="lf-icon" ng-class="strBrowseIconCls"></md-icon> ',"{{strCaptionBrowse}}",'<input type="file" aria-label="{{strAriaLabel}}" accept="{{accept}}" ng-disabled="isDisabled" class="lf-ng-md-file-input-tag" />',"</md-button>","</div>","</div>"].join(""))}]),e.filter("lfTrusted",["$sce",function(i){return function(e){return i.trustAsResourceUrl(e)}}]),e.directive("lfRequired",function(){return{restrict:"A",require:"ngModel",link:function(e,i,n,l){l&&(l.$validators.required=function(e,i){return!!e&&0<e.length})}}}),e.directive("lfMaxcount",function(){return{restrict:"A",require:"ngModel",link:function(e,i,n,l){var t;l&&(t=-1,n.$observe("lfMaxcount",function(e){e=parseInt(e,10);t=isNaN(e)?-1:e,l.$validate()}),l.$validators.maxcount=function(e,i){return!!e&&e.length<=t})}}}),e.directive("lfFilesize",function(){return{restrict:"A",require:"ngModel",link:function(e,i,n,t){var o;t&&(o=-1,n.$observe("lfFilesize",function(e){var n,l,i=/^[1-9][0-9]*(Byte|KB|MB)$/;i.test(e)?(n=e.match(i)[1],l=e.substring(0,e.indexOf(n)),["Byte","KB","MB"].every(function(e,i){return n!==e||(o=parseInt(l)*Math.pow(1024,i),!1)})):o=-1,t.$validate()}),t.$validators.filesize=function(e,i){if(!e)return!1;var n=!0;return e.every(function(e,i){return!(e.lfFile.size>o)||(n=!1)}),n})}}}),e.directive("lfTotalsize",function(){return{restrict:"A",require:"ngModel",link:function(e,i,n,t){var o;t&&(o=-1,n.$observe("lfTotalsize",function(e){var n,l,i=/^[1-9][0-9]*(Byte|KB|MB)$/;i.test(e)?(n=e.match(i)[1],l=e.substring(0,e.indexOf(n)),["Byte","KB","MB"].every(function(e,i){return n!==e||(o=parseInt(l)*Math.pow(1024,i),!1)})):o=-1,t.$validate()}),t.$validators.totalsize=function(e,i){if(!e)return!1;var n=0;return g.forEach(e,function(e,i){n+=e.lfFile.size}),n<o})}}}),e.directive("lfMimetype",function(){return{restrict:"A",require:"ngModel",link:function(e,i,n,l){var t;l&&(n.$observe("lfMimetype",function(e){e=e.replace(/,/g,"|");t=new RegExp(e,"i"),l.$validate()}),l.$validators.mimetype=function(e,i){if(!e)return!1;var n=!0;return e.every(function(e,i){return!(e.lfFile===v||!e.lfFile.type.match(t))||(n=!1)}),n})}}}),e.directive("lfNgMdFileInput",["$q","$compile","$timeout",function(d,e,m){return{restrict:"E",templateUrl:"lfNgMdFileinput.html",replace:!0,require:"ngModel",scope:{lfFiles:"=?",lfApi:"=?",lfOption:"=?",lfCaption:"@?",lfPlaceholder:"@?",lfDragAndDropLabel:"@?",lfBrowseLabel:"@?",lfRemoveLabel:"@?",lfSubmitLabel:"@?",lfOnFileClick:"=?",lfOnSubmitClick:"=?",lfOnFileRemove:"=?",accept:"@?",ngDisabled:"=?",ngChange:"&?"},link:function(o,e,i,n){var l=g.element(e[0].querySelector(".lf-ng-md-file-input-tag")),t=g.element(e[0].querySelector(".lf-ng-md-file-input-drag")),s=g.element(e[0].querySelector(".lf-ng-md-file-input-thumbnails")),r=0;o.intLoading=0,o.floatProgress=0,o.isPreview=!1,o.isDrag=!1,o.isMutiple=!1,o.isProgress=!1,o.isCustomCaption=!1,o.isSubmit=!1,g.isDefined(i.preview)&&(o.isPreview=!0),g.isDefined(i.drag)&&(o.isDrag=!0),g.isDefined(i.multiple)?(l.attr("multiple","multiple"),o.isMutiple=!0):l.removeAttr("multiple"),g.isDefined(i.progress)&&(o.isProgress=!0),g.isDefined(i.submit)&&(o.isSubmit=!0),o.isDisabled=!1,g.isDefined(i.ngDisabled)&&o.$watch("ngDisabled",function(e){o.isDisabled=e}),o.strBrowseIconCls="lf-browse",o.strRemoveIconCls="lf-remove",o.strCaptionIconCls="lf-caption",o.strSubmitIconCls="lf-submit",o.strUnknowIconCls="lf-unknow",o.strBrowseButtonCls="md-primary",o.strRemoveButtonCls="",o.strSubmitButtonCls="md-accent",g.isDefined(i.lfOption)&&g.isObject(o.lfOption)&&(o.lfOption.hasOwnProperty("browseIconCls")&&(o.strBrowseIconCls=o.lfOption.browseIconCls),o.lfOption.hasOwnProperty("removeIconCls")&&(o.strRemoveIconCls=o.lfOption.removeIconCls),o.lfOption.hasOwnProperty("captionIconCls")&&(o.strCaptionIconCls=o.lfOption.captionIconCls),o.lfOption.hasOwnProperty("unknowIconCls")&&(o.strUnknowIconCls=o.lfOption.unknowIconCls),o.lfOption.hasOwnProperty("submitIconCls")&&(o.strSubmitIconCls=o.lfOption.submitIconCls),o.lfOption.hasOwnProperty("strBrowseButtonCls")&&(o.strBrowseButtonCls=o.lfOption.strBrowseButtonCls),o.lfOption.hasOwnProperty("strRemoveButtonCls")&&(o.strRemoveButtonCls=o.lfOption.strRemoveButtonCls),o.lfOption.hasOwnProperty("strSubmitButtonCls")&&(o.strSubmitButtonCls=o.lfOption.strSubmitButtonCls)),o.accept=o.accept||"",o.lfFiles=[],o[i.ngModel]=o.lfFiles,o.lfApi=new function(){this.removeAll=function(){o.removeAllFiles()},this.removeByName=function(e){o.removeFileByName(e)},this.addRemoteFile=function(e,i,n){var l,l=(l=e,n={name:e=i,type:i=n},{key:b(),lfFile:void 0,lfFileName:e,lfFileType:i,lfTagType:C(n),lfDataUrl:l,isRemote:!0});o.lfFiles.push(l)}},o.strCaption="",o.strCaptionPlaceholder="Select file",o.strCaptionDragAndDrop="Drag & drop files here...",o.strCaptionBrowse="Browse",o.strCaptionRemove="Remove",o.strCaptionSubmit="Submit",o.strAriaLabel="",g.isDefined(i.ariaLabel)&&(o.strAriaLabel=i.ariaLabel),g.isDefined(i.lfPlaceholder)&&o.$watch("lfPlaceholder",function(e){o.strCaptionPlaceholder=e}),g.isDefined(i.lfCaption)&&(o.isCustomCaption=!0,o.$watch("lfCaption",function(e){o.strCaption=e})),o.lfDragAndDropLabel&&(o.strCaptionDragAndDrop=o.lfDragAndDropLabel),o.lfBrowseLabel&&(o.strCaptionBrowse=o.lfBrowseLabel),o.lfRemoveLabel&&(o.strCaptionRemove=o.lfRemoveLabel),o.lfSubmitLabel&&(o.strCaptionSubmit=o.lfSubmitLabel),o.openDialog=function(e,i){e&&m(function(){e.preventDefault(),e.stopPropagation(),e.target.children[2]!==v&&l[0].click()},0)},o.removeAllFilesWithoutVaildate=function(){o.isDisabled||(o.lfFiles.length=0,s.empty())},o.removeAllFiles=function(e){o.removeAllFilesWithoutVaildate(),f()},o.removeFileByName=function(n,e){o.isDisabled||(o.lfFiles.every(function(e,i){return e.lfFileName!=n||(o.lfFiles.splice(i,1),!1)}),f())},o.removeFile=function(n){o.lfFiles.every(function(e,i){return e.key!=n.key||(g.isFunction(o.lfOnFileRemove)&&o.lfOnFileRemove(e,i),o.lfFiles.splice(i,1),!1)}),f()},o.onFileClick=function(n){g.isFunction(o.lfOnFileClick)&&o.lfFiles.every(function(e,i){return e.key!=n.key||(o.lfOnFileClick(e,i),!1)})},o.onSubmitClick=function(){g.isFunction(o.lfOnSubmitClick)&&o.lfOnSubmitClick(o.lfFiles)},t.bind("dragover",function(e){e.stopPropagation(),e.preventDefault(),!o.isDisabled&&o.isDrag&&t.addClass("lf-ng-md-file-input-drag-hover")}),t.bind("dragleave",function(e){e.stopPropagation(),e.preventDefault(),!o.isDisabled&&o.isDrag&&t.removeClass("lf-ng-md-file-input-drag-hover")}),t.bind("drop",function(e){var i,n,l;e.stopPropagation(),e.preventDefault(),!o.isDisabled&&o.isDrag&&(t.removeClass("lf-ng-md-file-input-drag-hover"),g.isObject(e.originalEvent)&&(e=e.originalEvent),i=e.target.files||e.dataTransfer.files,e=o.accept.replace(/,/g,"|"),n=new RegExp(e,"i"),l=[],g.forEach(i,function(e,i){e.type.match(n)&&l.push(e)}),a(l))}),l.bind("change",function(e){e=e.files||e.target.files;a(e)});var a=function(e){if(!(e.length<=0)){o.lfFiles.map(function(e){return e.lfFileName});if(o.floatProgress=0,o.isMutiple){r=e.length,o.intLoading=r;for(var i=0;i<e.length;i++){var n=e[i];setTimeout(c(n),100*i)}}else{r=1,o.intLoading=r;for(i=0;i<e.length;i++){n=e[i];o.removeAllFilesWithoutVaildate(),c(n);break}}l.val("")}},f=function(){g.isFunction(o.ngChange)&&o.ngChange(),n.$validate()},c=function(t){u(t).then(function(e){var i,l=!1;o.lfFiles.every(function(e,i){var n=e.lfFile;return!!e.isRemote||(n.name===v||n.name!=t.name||(n.size==t.size&&n.lastModified==t.lastModified&&(l=!0),!1))}),l||(i=t,i={key:b(),lfFile:i,lfFileName:i.name,lfFileType:i.type,lfTagType:C(i),lfDataUrl:p.URL.createObjectURL(i),isRemote:!1},o.lfFiles.push(i)),0==o.intLoading&&f()},function(e){},function(e){})},u=function(e,i){var n=d.defer(),l=new FileReader;return l.onloadstart=function(){n.notify(0)},l.onload=function(e){},l.onloadend=function(e){n.resolve({index:i,result:l.result}),o.intLoading--,o.floatProgress=(r-o.intLoading)/r*100},l.onerror=function(e){n.reject(l.result),o.intLoading--,o.floatProgress=(r-o.intLoading)/r*100},l.onprogress=function(e){n.notify(e.loaded/e.total)},l.readAsArrayBuffer(e),n.promise}}}}])}(window,window.angular);